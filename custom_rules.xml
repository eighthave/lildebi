<?xml version="1.0" encoding="UTF-8"?>
<project>

  <target name="-getgitdetails" >
    <exec executable="git" outputproperty="git.describe">
      <arg value="describe"/>
    </exec>
    <exec executable="git" outputproperty="git.revision">
      <arg value="rev-parse"/>
      <arg value="HEAD"/>
    </exec>
  </target>

  <target name="rename-release-with-version-number" depends="-getgitdetails">
    <xmlproperty file="AndroidManifest.xml"
                 prefix="themanifest"
                 collapseAttributes="true"/>
    <!--  see ${sdk.dir}/tools/ant/build.xml -set-release-mode -->
    <property name="out.packaged.file"
              location="${out.absolute.dir}/${ant.project.name}-${git.describe}-unsigned.apk" />
    <property name="out.final.file"
              location="${out.absolute.dir}/${ant.project.name}-${git.describe}.apk" />
  </target>

  <target name="-set-release-mode"
          depends="rename-release-with-version-number,android_rules.-set-release-mode">
    <echo message="target: ${build.target}"></echo>
  </target>

  <target name="-pre-build">
    <tstamp>
      <format property="current.timestamp" pattern="yyyyMMddHHmm.ss" />
    </tstamp>
    <echo message="timestamp: ${current.timestamp}"></echo>
    <apply executable="touch" parallel="true" verbose="true">
      <arg value="-t"/>
      <arg value="${current.timestamp}"/>
      <fileset dir="assets" casesensitive="yes">
        <include name="*"/>
      </fileset>
    </apply>
  </target>

</project>
